name: Validate Scripts

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Install PowerShell
      uses: actions/setup-powershell@v2
    
    - name: Validate PowerShell syntax
      run: |
        $ErrorActionPreference = 'Stop'
        $scripts = Get-ChildItem -Path scripts -Filter *.ps1
        foreach ($script in $scripts) {
          Write-Host "Validating $($script.Name)..."
          # Test script syntax without executing
          $null = [System.Management.Automation.PSParser]::Tokenize((Get-Content $script.FullName -Raw), [ref]$null)
          Write-Host "âœ“ $($script.Name) syntax is valid"
        }
        Write-Host "`nAll scripts validated successfully!"

